<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdminCenter</title>
    <style>
       
        .kontroll {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #details{

            margin-top:15px;

            border: 1px solid rgb(132, 130, 130);
        }

        
    </style>
</head>

<body>
    <h1 style="text-align: center;">AdminCenter</h1><br>

    <div class="kontroll">
        

        <select id="userSelect">
            <option value="">-- Válassz felhasználót --</option>
        </select>

        <div id="details">
    </div>


    </div>


    <script>
        let allUsers = []; 

        async function loadUsers() {
            try {
                const response = await fetch('/users_notes');
                if (!response.ok) {
                    document.getElementById("details").textContent = "Hiba: " + response.status;
                    return;
                }

                allUsers = await response.json();
                const select = document.getElementById("userSelect");

                
                select.innerHTML = '<option value="">-- Válassz felhasználót --</option>';

               
                allUsers.forEach(user => {
                    const opt = document.createElement("option");
                    opt.value = user.username;
                    opt.textContent = user.username;
                    select.appendChild(opt);
                });

                
                if (select.value) {
                    showUserDetails(select.value);
                } else {
                    document.getElementById("details").innerHTML = "";
                }

            } catch (err) {
                console.error("Hiba a lekérés közben:", err);
            }
        }

        function showUserDetails(username) {
            const selected = allUsers.find(u => u.username === username);
            if (selected) {
                document.getElementById("details").innerHTML = `
                    <p><b>Felhasználónév:</b> ${selected.username}</p>
                    <p><b>Email:</b> ${selected.email}</p>
                    <p><b>Szerep:</b> ${selected.role}</p>
                    <p><b>Regisztráció:</b> ${selected.registeredAt}</p>
                    <p><b>Utolsó login:</b> ${selected.lastLogin}</p>
                    <p><b>Jegyzetek:</b></p>
                    ${selected.notes && selected.notes.length > 0
                        ? "<ul>" + selected.notes.map(note => `<li>${note}</li>`).join("") + "</ul>"
                        : "<p>Nincsenek jegyzetek</p>"
                    }
                `;
            } else {
                document.getElementById("details").innerHTML = "";
            }
        }

        
        document.getElementById("userSelect").addEventListener("change", e => {
            if (e.target.value) {
                showUserDetails(e.target.value);
            } else {
                document.getElementById("details").innerHTML = "";
            }
        });

        
        loadUsers();
        
    </script>
</body>

</html>